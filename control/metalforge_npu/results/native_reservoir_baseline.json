{
  "provenance": {
    "generator": "control/metalforge_npu/scripts/native_int4_reservoir.py",
    "method": "Native int4+ReLU reservoir (hardware-native design)",
    "date": "2026-02-20",
    "numpy_version": "2.1.3"
  },
  "config": {
    "input_size": 8,
    "reservoir_size": 50,
    "connectivity": 0.2,
    "leak_rate": 0.3,
    "spectral_radius": 0.9,
    "max_activation": 7.0,
    "weight_type": "ternary_int4",
    "activation": "bounded_relu"
  },
  "sparsity": {
    "w_in_sparsity": 0.495,
    "w_res_sparsity": 0.7996,
    "w_in_unique_values": 3,
    "w_res_unique_values": 3,
    "w_in_ternary": true,
    "w_res_ternary": true
  },
  "activation_sparsity": 0.2238,
  "macs": {
    "dense_per_step": 2900,
    "sparse_per_step": 451,
    "savings_pct": 84.44827586206897
  },
  "cases": [
    {
      "case": 0,
      "kappa": 1.0,
      "gamma": 10.0,
      "split": "train",
      "target_d_star": 0.11713364547537425,
      "pred_native_int4": 0.10762045726137408,
      "pred_tanh_f64": 0.1124122857749836,
      "err_native_pct": 8.121652984837894
    },
    {
      "case": 1,
      "kappa": 1.0,
      "gamma": 50.0,
      "split": "train",
      "target_d_star": 0.05238375874705949,
      "pred_native_int4": 0.05388963856336597,
      "pred_tanh_f64": 0.056130041721642154,
      "err_native_pct": 2.874707451937107
    },
    {
      "case": 2,
      "kappa": 1.0,
      "gamma": 175.0,
      "split": "train",
      "target_d_star": 0.028000296837559887,
      "pred_native_int4": 0.038822980606930145,
      "pred_tanh_f64": 0.03392308381913553,
      "err_native_pct": 38.65203227007436
    },
    {
      "case": 3,
      "kappa": 2.0,
      "gamma": 10.0,
      "split": "train",
      "target_d_star": 0.0867747388230299,
      "pred_native_int4": 0.08145925500482634,
      "pred_tanh_f64": 0.07974116369964795,
      "err_native_pct": 6.125612004484459
    },
    {
      "case": 4,
      "kappa": 2.0,
      "gamma": 50.0,
      "split": "train",
      "target_d_star": 0.038806842947616986,
      "pred_native_int4": 0.044468313175998087,
      "pred_tanh_f64": 0.04094602531543727,
      "err_native_pct": 14.588845158115998
    },
    {
      "case": 5,
      "kappa": 2.0,
      "gamma": 175.0,
      "split": "train",
      "target_d_star": 0.020743130081761048,
      "pred_native_int4": 0.017576122298315507,
      "pred_tanh_f64": 0.020382051630986848,
      "err_native_pct": 15.267742963393054
    },
    {
      "case": 6,
      "kappa": 1.5,
      "gamma": 30.0,
      "split": "test",
      "target_d_star": 0.05820722032392825,
      "pred_native_int4": 0.13694418555461732,
      "pred_tanh_f64": 0.0750022083269995,
      "err_native_pct": 135.27010015683794
    },
    {
      "case": 7,
      "kappa": 1.5,
      "gamma": 100.0,
      "split": "test",
      "target_d_star": 0.03188140758108867,
      "pred_native_int4": 0.02792446648688866,
      "pred_tanh_f64": 0.06791614487116918,
      "err_native_pct": 12.411437870601356
    }
  ],
  "summary": {
    "native_train_err_pct": 14.271765472140482,
    "native_test_err_pct": 73.84076901371964,
    "tanh_train_err_pct": 7.948932989051298,
    "tanh_test_err_pct": 70.9406116360165
  }
}